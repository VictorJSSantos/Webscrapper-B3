{
	"dag": {
		"node-1734478386043": {
			"classification": "DataSource",
			"type": "S3",
			"name": "Source B3",
			"inputs": [],
			"isCatalog": false,
			"recurse": true,
			"paths": [
				"s3://s3-fiap-etl-250461282134/raw/"
			],
			"additionalOptions": {
				"enableSamplePath": false,
				"samplePath": "s3://s3-fiap-etl-250461282134/raw/2024_12_16.parquet"
			},
			"inferSchemaChanged": false,
			"format": "parquet",
			"iconUrl": "https://a.b.cdn.console.awsstatic.com/a/v1/VXD5H7THCKGZZCJQTJZBGDVEAZESABM5ZVABZUBKOWGSIDTH4K4Q/static/media/s3.2a166713.svg",
			"generatedNodeName": "SourceB3_node1734478386043",
			"codeGenVersion": 2,
			"outputSchemas": [
				[
					{
						"key": "codigo",
						"fullPath": [
							"codigo"
						],
						"type": "string"
					},
					{
						"key": "acao",
						"fullPath": [
							"acao"
						],
						"type": "string"
					},
					{
						"key": "tipo",
						"fullPath": [
							"tipo"
						],
						"type": "string"
					},
					{
						"key": "qtde_teorica",
						"fullPath": [
							"qtde_teorica"
						],
						"type": "long"
					},
					{
						"key": "participacao_percentual",
						"fullPath": [
							"participacao_percentual"
						],
						"type": "double"
					},
					{
						"key": "info_extraction_date",
						"fullPath": [
							"info_extraction_date"
						],
						"type": "string"
					}
				]
			]
		},
		"node-1734478729098": {
			"classification": "Transform",
			"type": "RenameField",
			"name": "Renomear qtde_teorica",
			"inputs": [
				"node-1734478386043"
			],
			"sourcePath": "qtde_teorica",
			"targetPath": "quantidade_teorica",
			"iconUrl": "https://a.b.cdn.console.awsstatic.com/a/v1/VXD5H7THCKGZZCJQTJZBGDVEAZESABM5ZVABZUBKOWGSIDTH4K4Q/static/media/Rename-fields.c1e54441.svg",
			"generatedNodeName": "Renomearqtde_teorica_node1734478729098",
			"codeGenVersion": 2,
			"outputSchemas": [
				[
					{
						"key": "codigo",
						"fullPath": [
							"codigo"
						],
						"type": "string"
					},
					{
						"key": "acao",
						"fullPath": [
							"acao"
						],
						"type": "string"
					},
					{
						"key": "tipo",
						"fullPath": [
							"tipo"
						],
						"type": "string"
					},
					{
						"key": "participacao_percentual",
						"fullPath": [
							"participacao_percentual"
						],
						"type": "double"
					},
					{
						"key": "info_extraction_date",
						"fullPath": [
							"info_extraction_date"
						],
						"type": "string"
					},
					{
						"key": "quantidade_teorica",
						"fullPath": [
							"quantidade_teorica"
						],
						"type": "long"
					}
				]
			]
		},
		"node-1734478796890": {
			"classification": "Transform",
			"type": "RenameField",
			"name": "Renomear participacao_percentual",
			"inputs": [
				"node-1734478729098"
			],
			"sourcePath": "participacao_percentual",
			"targetPath": "percentual_participacao",
			"iconUrl": "https://a.b.cdn.console.awsstatic.com/a/v1/VXD5H7THCKGZZCJQTJZBGDVEAZESABM5ZVABZUBKOWGSIDTH4K4Q/static/media/Rename-fields.c1e54441.svg",
			"generatedNodeName": "Renomearparticipacao_percentual_node1734478796890",
			"codeGenVersion": 2,
			"outputSchemas": [
				[
					{
						"key": "codigo",
						"fullPath": [
							"codigo"
						],
						"type": "string"
					},
					{
						"key": "acao",
						"fullPath": [
							"acao"
						],
						"type": "string"
					},
					{
						"key": "tipo",
						"fullPath": [
							"tipo"
						],
						"type": "string"
					},
					{
						"key": "info_extraction_date",
						"fullPath": [
							"info_extraction_date"
						],
						"type": "string"
					},
					{
						"key": "quantidade_teorica",
						"fullPath": [
							"quantidade_teorica"
						],
						"type": "long"
					},
					{
						"key": "percentual_participacao",
						"fullPath": [
							"percentual_participacao"
						],
						"type": "double"
					}
				]
			]
		},
		"node-1734482757943": {
			"classification": "Transform",
			"type": "SqlCode",
			"name": "SQL Query",
			"inputs": [
				"node-1734478796890"
			],
			"sqlAliases": [
				{
					"from": "node-1734478796890",
					"alias": "myDataSource"
				}
			],
			"sqlQuery": "SELECT \n    acao,\n    tipo,\n    info_extraction_date,\n    dias_desde_extracao,\n    quantidade_teorica,\n    percentual_participacao\nFROM (\n    SELECT \n        acao,\n        tipo,\n        info_extraction_date,\n        DATEDIFF(\n            TO_DATE(REPLACE(info_extraction_date, '_', '-')), \n            '2024-01-01'\n        ) AS dias_desde_extracao,\n        quantidade_teorica,\n        percentual_participacao\n    FROM myDataSource\n) subquery\nORDER BY percentual_participacao DESC\nLIMIT 10;",
			"iconUrl": "https://a.b.cdn.console.awsstatic.com/a/v1/VXD5H7THCKGZZCJQTJZBGDVEAZESABM5ZVABZUBKOWGSIDTH4K4Q/static/media/SQL.897bb48d.svg",
			"generatedNodeName": "SQLQuery_node1734482757943",
			"codeGenVersion": 2,
			"outputSchemas": [
				[
					{
						"key": "acao",
						"fullPath": [
							"acao"
						],
						"type": "string"
					},
					{
						"key": "tipo",
						"fullPath": [
							"tipo"
						],
						"type": "string"
					},
					{
						"key": "info_extraction_date",
						"fullPath": [
							"info_extraction_date"
						],
						"type": "string"
					},
					{
						"key": "dias_desde_extracao",
						"fullPath": [
							"dias_desde_extracao"
						],
						"type": "int"
					},
					{
						"key": "quantidade_teorica",
						"fullPath": [
							"quantidade_teorica"
						],
						"type": "long"
					},
					{
						"key": "percentual_participacao",
						"fullPath": [
							"percentual_participacao"
						],
						"type": "double"
					}
				]
			]
		},
		"node-1734482806327": {
			"classification": "DataSink",
			"type": "S3",
			"name": "B3 Data Refined",
			"inputs": [
				"node-1734482757943"
			],
			"format": "glueparquet",
			"compression": "snappy",
			"path": "s3://s3-fiap-etl-250461282134/refined/",
			"partitionKeys": [],
			"updateCatalogOptions": "schemaAndPartitions",
			"schemaChangePolicy": {
				"enableUpdateCatalog": true,
				"updateBehavior": "UPDATE_IN_DATABASE",
				"database": "fiap",
				"table": "bovespa_glue_refined"
			},
			"autoDataQuality": {
				"isEnabled": true,
				"evaluationContext": "EvaluateDataQuality_node1734478314234"
			},
			"additionalOptions": {},
			"iconUrl": "https://a.b.cdn.console.awsstatic.com/a/v1/VXD5H7THCKGZZCJQTJZBGDVEAZESABM5ZVABZUBKOWGSIDTH4K4Q/static/media/s3.2a166713.svg",
			"generatedNodeName": "B3DataRefined_node1734482806327",
			"codeGenVersion": 2
		}
	},
	"jobConfig": {
		"command": "glueetl",
		"description": "",
		"role": "arn:aws:iam::491085393996:role/LabRole",
		"scriptName": "B3DataProcessingJob.py",
		"version": "5.0",
		"language": "python-3",
		"scriptLocation": "s3://aws-glue-assets-491085393996-us-east-1/scripts/",
		"temporaryDirectory": "s3://aws-glue-assets-491085393996-us-east-1/temporary/",
		"timeout": "60",
		"maxConcurrentRuns": 1,
		"workerType": "G.1X",
		"numberOfWorkers": "2",
		"maxRetries": 0,
		"metrics": true,
		"observabilityMetrics": true,
		"security": "none",
		"bookmark": "job-bookmark-disable",
		"logging": true,
		"spark": true,
		"sparkConfiguration": "standard",
		"sparkPath": "s3://aws-glue-assets-491085393996-us-east-1/sparkHistoryLogs/",
		"serverEncryption": false,
		"glueHiveMetastore": true,
		"etlAutoScaling": false,
		"etlAutoTuning": true,
		"jobParameters": [],
		"tags": [],
		"connectionsList": [],
		"jobMode": "VISUAL_MODE",
		"name": "B3DataProcessingJob",
		"pythonPath": ""
	},
	"hasBeenSaved": false
}